const DEFAULTS={enableEffect:!0,accentColor:'#00ffea',glowStrength:70,minLinkSize:'30x12'};function syncBadge(e){try{chrome.action.setBadgeText({text:e?'ON':'OFF'}),chrome.action.setBadgeBackgroundColor({color:e?'#10b981':'#6b7280'})}catch(e){}}async function load(){const e=await chrome.storage.sync.get(DEFAULTS);document.getElementById('enableEffect').checked=!!e.enableEffect,document.getElementById('accentColor').value=e.accentColor||DEFAULTS.accentColor,document.getElementById('glowStrength').value=String(null!=e.glowStrength?e.glowStrength:DEFAULTS.glowStrength),document.getElementById('minLinkSize').value=e.minLinkSize||DEFAULTS.minLinkSize,syncBadge(!!e.enableEffect)}async function save(e){e.preventDefault();const t=document.getElementById('enableEffect').checked,a=document.getElementById('accentColor').value,n=parseInt(document.getElementById('glowStrength').value,10)||0,o=(document.getElementById('minLinkSize').value||'30x12').toLowerCase(),s=/^(\d{1,3})x(\d{1,3})$/.test(o),i=document.getElementById('status');if(!s)return i.textContent='Formato inválido. Use LxA, ex: 30x12.',void(i.className='error');await chrome.storage.sync.set({enableEffect:t,accentColor:a,glowStrength:n,minLinkSize:o}),i.textContent='Salvo!',i.className='ok',syncBadge(t);try{chrome.tabs.query({url:'https://developer.chrome.com/*'},e=>{e.forEach(e=>chrome.tabs.sendMessage(e.id,{type:'BH_SETTINGS_UPDATED'}))})}catch(e){}}document.getElementById('form').addEventListener('submit',save),document.getElementById('reset').addEventListener('click',async()=>{await chrome.storage.sync.set({...DEFAULTS}),await load();const e=document.getElementById('status');e.textContent='Configurações restauradas.',e.className='ok'}),load();